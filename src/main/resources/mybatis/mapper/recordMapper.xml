<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.intern_project.record.mapper.RecordMapper">
    <insert id="saveRecord" parameterType="object">
        insert into pain_record_groups (user_id, pain_area, pain_area_detail, start_date, pain_start_pattern,
                                        pain_duration)
        values (#{userId}, #{painArea}, #{painAreaDetail}, #{painStartDateTime}, #{painStartPattern}, #{painDuration});
        <selectKey resultType="Long" keyProperty="id" keyColumn="id" order="AFTER">
            SELECT LAST_INSERT_ID()
        </selectKey>
    </insert>

    <insert id="saveSymptoms">
        INSERT INTO record_symptoms (symptom_id, record_detail_id)
        VALUES
        <foreach collection="symptoms" item="symptom" separator=",">
        (#{symptom}, #{recordDetailId})
        </foreach>
    </insert>

    <insert id="saveRecordDetail">
        insert into pain_record (record_group_id, pain_intensity, pain_mood, created_at, note, pain_start_time, pain_end_time, is_initial_record)
        values (#{recordGroupId}, #{painIntensity}, #{painMood}, #{createdAt}, #{note}, #{painStartTime}, #{painEndTime}, #{isInitialRecord});
        <selectKey resultType="Long" keyProperty="id" keyColumn="id" order="AFTER">
            SELECT LAST_INSERT_ID()
        </selectKey>
    </insert>


</mapper>